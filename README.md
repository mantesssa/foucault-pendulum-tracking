**Foucault pendulum tracking**



Схема
![scheme](fpt/uf.png)

Запуск:
```
python vserver.py
python client2.py    # classic cv
       client2v2.py  # Haar Cascade classifier
       client3.py    # YOLOv8n
python vserver.py  
```


Реализация client2.py

1. Обрезаема изображение в области интереса
2. Конвертируем в оттенки серого
3. Выделяем движущиеся объекты (cv2.createBackgroundSubtractorMOG2())
4. Накладываем Размытие по Гаусу (cv2.GaussianBlur())
5. Ищем Круги Хафа (cv2.HoughCircles())
6. полученные координаты переводим в bbox 
7. Рисуем bbox и вектор
8. отправляем данные об обнаружении клиенту по grpc

Реализация client2v2.py

Обучение происходило на том же датасете что и нейронка. Позитивные образцы были собраны из ограничивающих рамок набора данных, негативные образцы были выбраны случайными картинками на изображениях из набора данных которые не пересекаются с bbox шара
Обучение длилось 10 этапов.
Количество положительных изображенией: 800.
количество негативных изображенией: 800.
Размер сэмпла: 24 x 24 пикселя.

1. Обрезаема изображение в области интереса
2. Конвертируем в оттенки серого
3. Ищем шар с помощью каскадов Хаара
4. Рисуем bbox и вектор
5. отправляем данные об обнаружении клиенту по grpc

Реализация client3.py

Для обучения нейронной сети использовался набор данных из размеченных кадров из стрима и составил 897 картинок.
Модель: YOLOv8n.
Обучение происходило на 400 эпохах.
Размер входного изображения 320 пикселя.
Размер батча = 64.

Результаты обучения:
Box(P=1, R=1, mAP50=0.995,  mAP50-95=0.838)


1. Обрезаема изображение в области интереса
2. Конвертируем в оттенки серого
3. Ищем шар с помощью YOLOv8n
4. Рисуем bbox и вектор
5. отправляем данные об обнаружении клиенту по grpc


